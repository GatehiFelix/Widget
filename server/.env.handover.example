# ============================================
# HANDOVER & AGENT ROUTING CONFIGURATION
# ============================================

# External Agent Database Configuration
# Set to 'true' to enable fetching agents from an external database
EXTERNAL_AGENT_DB_ENABLED=false

# Database type: mysql, postgres, mssql, or api
EXTERNAL_AGENT_DB_TYPE=mysql

# Connection string for external agent database
# Example for MySQL: mysql://username:password@host:port/database
# Example for PostgreSQL: postgresql://username:password@host:port/database
EXTERNAL_AGENT_DB_URI=

# For API-based agent source
EXTERNAL_AGENT_API_URL=
EXTERNAL_AGENT_API_KEY=

# Table and field mappings for external database
# (Adjust these if your external DB has different column names)
EXTERNAL_AGENT_TABLE_NAME=agents
EXTERNAL_AGENT_FIELD_ID=id
EXTERNAL_AGENT_FIELD_NAME=name
EXTERNAL_AGENT_FIELD_EMAIL=email
EXTERNAL_AGENT_FIELD_STATUS=status
EXTERNAL_AGENT_FIELD_CLIENT_ID=client_id
EXTERNAL_AGENT_FIELD_MAX_CHATS=max_concurrent_chats
EXTERNAL_AGENT_FIELD_CURRENT_CHATS=current_chat_count
EXTERNAL_AGENT_FIELD_DEPARTMENT=department
EXTERNAL_AGENT_FIELD_SKILLS=skills

# Agent Routing Configuration
# Prefer local agents over external agents when both are available
PREFER_LOCAL_AGENTS=true

# Enable round-robin agent assignment
AGENT_ROUND_ROBIN=false

# Enable skill-based routing (requires skills data in agent records)
SKILL_BASED_ROUTING=false

# Queue timeout in milliseconds (default: 10 minutes)
# Customers will be removed from queue after this time
QUEUE_TIMEOUT_MS=600000

# ============================================
# INTELLIGENT HANDOVER DETECTION SETTINGS
# ============================================

# These are hardcoded in handoverDetectionService.js but can be customized there:
# - MAX_BACK_AND_FORTH: 4 (trigger after 4 back-and-forth exchanges)
# - MAX_SIMILAR_QUESTIONS: 2 (trigger if user asks similar question 2+ times)
# - LOW_CONFIDENCE_SCORE: 0.4 (trigger if AI confidence below 0.4)

# ============================================
# EXAMPLE EXTERNAL AGENT DATABASE STRUCTURE
# ============================================

# If using an external database, it should have a table with at least these fields:
# - id (INT/BIGINT) - Agent unique identifier
# - name (VARCHAR) - Agent name
# - email (VARCHAR) - Agent email
# - status (VARCHAR/ENUM) - Agent status: 'online', 'offline', 'busy', 'away'
# - client_id (INT/BIGINT) - Which client/tenant this agent belongs to
# - max_concurrent_chats (INT) - Maximum chats this agent can handle
# - current_chat_count (INT) - Current number of active chats
# - department (VARCHAR) - Optional: Agent department
# - skills (JSON/TEXT) - Optional: JSON array of skills

# Example SQL to create external agents table:
# CREATE TABLE agents (
#   id BIGINT PRIMARY KEY AUTO_INCREMENT,
#   name VARCHAR(255) NOT NULL,
#   email VARCHAR(255) NOT NULL,
#   status ENUM('online', 'offline', 'busy', 'away') DEFAULT 'offline',
#   client_id BIGINT NOT NULL,
#   max_concurrent_chats INT DEFAULT 5,
#   current_chat_count INT DEFAULT 0,
#   department VARCHAR(100),
#   skills JSON,
#   created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
#   INDEX idx_client_status (client_id, status),
#   INDEX idx_availability (client_id, status, current_chat_count)
# );
